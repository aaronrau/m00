function cELM(e,t){var n=document.createElement(e);return t&&(n.className=t),n}function isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function getURLParameter(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function checkBrowserCompatibility(){}function HtmlEncode(e){var t=document.createElement("div");return t.innerText=t.textContent=e,e=t.innerHTML}function IsEmpty(e){return!e||0===e.length||/^\s*$/.test(e)}function contains(e,t){return e.indexOf(t)!=-1}function RGBAObjToHex(e){var t=parseInt(255*e.r),n=parseInt(255*e.g),o=parseInt(255*e.b);return"#"+t.toString(16)+n.toString(16)+o.toString(16)}function GetScreenDim(){var e=window,t=document,n=t.documentElement,o=t.getElementsByTagName("body")[0],i=e.innerWidth||n.clientWidth||o.clientWidth,r=e.innerHeight||n.clientHeight||o.clientHeight;return{width:i,height:r}}function LoadCSS(e){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e;for(var n=!1,o=0;o<document.getElementsByTagName("head")[0].children.length;o++){var i=document.getElementsByTagName("head")[0].children[o];if(i.href==t){n=!0;break}}n||document.getElementsByTagName("head")[0].appendChild(t)}function guidGenerator(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function URLFriendly(e){if(IsEmpty(e))return"";var t=e.toLowerCase().replace(/^\s+|\s+$/g,"").replace(/[^a-zA-Z\d\s]/g,"").replace(/\s/g,"-");return t}function URLFriendlyTags(e){var t=e.toLowerCase().replace(/^\s+|\s+$/g,"").replace(/[^a-zA-Z\d\s]/g,"").replace(/\s/g,"+");return t}function setCookie(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var i="expires="+o.toGMTString();document.cookie=e+"="+t+"; "+i+";path=/"}function getCookie(e){var t=new RegExp(e+"=([^;]+)"),n=t.exec(document.cookie);return null!=n?unescape(n[1]):null}function getStoredKVP(e){return"undefined"!=typeof Storage?localStorage.getItem(e):getCookie(e)}function setStoredKVP(e,t){"undefined"!=typeof Storage?localStorage.setItem(e,t):setCookie(e,t,325)}function httpGet(e,t,n){var o="";if(t){var i=(new Date).getTime();for(var r in t)o+=o+"&"+r+"="+t[r];o=e.indexOf("?")>-1?"&dt="+i+o:"?dt="+i+o}var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&200==a.status)try{n(JSON.parse(a.responseText))}catch(e){n(a.responseText)}},a.open("GET",e+o,!0),a.send(null)}function getURLParts(e){for(var t=[],n=e.pathname.split("/"),o=0;o<n.length;o++)o>0&&(IsEmpty(n[o])||t.push(n[o]));return t}function getURLHashPath(e){var t=[];if(e.hash){query=e.hash.substr(1);return query.split("/").forEach(function(e){t.push(e)}),t}return t}function getURLQueryParams(e,t){var n={};if(t.hash){n=t.hash.substr(1);var o={};return n.split("&").forEach(function(e){var t=e.split("=");o[t[0]]=decodeURIComponent(t[1])}),o}n=t.search.substr(1);var o={};return n.split("&").forEach(function(e){var t=e.split("=");o[t[0]]=decodeURIComponent(t[1])}),o}var app=app||{};app.Ext=function(e){e=e||{};for(var t=1;t<arguments.length;t++){var n=arguments[t];if(n)for(var o in n)n.hasOwnProperty(o)&&("object"==typeof n[o]?e[o]=app.Ext(e[o],n[o]):e[o]=n[o])}return e},Element.prototype.addELM=function(e){var t=e;return e.getHTML&&(t=e.getHTML()),this.appendChild(t)},Element.prototype.insertELM=function(e){var t=e;e.getHTML&&(t=e.getHTML());var n=this.firstChild;return n?this.insertBefore(t,n):this.appendChild(t)},Element.prototype.removeELM=function(e){var t=e;return e.destroy&&e.destroy(),e.getELM&&(t=e.getELM()),this.removeChild(t)};var logout=function(){setCookie("username","",325),setCookie("userId","",325),setCookie("session_token","",325),Parse.User.logOut(),setTimeout(function(){location.reload()},800)},_LOGIN_PARAMS=null;app.Start=function(e,t,n){document.addEventListener("DOMContentLoaded",function(o){app.Init(e,t,n)})},app.FF=function(e){return app.Controller.checkFeature(e)},app.Init=function(e,t,n){if(!t||t()){var o=e.sections?e.sections:{},i=Parse.User.current();if(i){var r=i.get("sections"),a=i.get("overrideSections"),s=i.get("sectionBadges");if(app.Controller.sectionBadges=s,app.Controller.setFeatureFlags({}),a&&r){var l={};for(var c in r)if(r[c].features)for(var d in r[c].features){var u=r[c].features[d];u&&(l[c.toUpperCase()+"-"+d.toUpperCase()]=!0)}app.Controller.setFeatureFlags(l)}if(r)if(a)o=r;else for(var c in r)o[c]=r[c]}if(document.getElementById("btLogin"))if(i){document.getElementById("btLogin").style.display="none";var p=document.getElementById("username");p&&(p.innerHTML=i.get("username"));var f=document.getElementById("userprofile"),g=i.get("profileURL");g||(g="/images/profile_default.png");var v=new app.controls.ExpandButton({button_text:"<img src="+g+">",classname:"profile_nav",selections:[{classname:"ep_logout",text:"Logout",detailText:"Signout of my current account",onclick:function(){logout()}}]});p&&(p.onclick=function(e){v.click(e)}),f.addELM(v)}else document.getElementById("username")&&(document.getElementById("username").style.display="none"),document.getElementById("userprofile").style.display="none";else initLoginType(e?e.login?e:"login":"login");e&&e.login&&(_LOGIN_PARAMS=e.login),app.Controller.initSectionSelections(o),app.Controller.showSection(),n&&n()}};var logo=function(){window.location="/"},popup,lPopup,initLoginType=function(e){var t=null,n=null;"object"==typeof e?(n=e.login.mode,t=e,_LOGIN_PARAMS=e.login):"string"==typeof e&&(n=e,_LOGIN_PARAMS=e);var o=document.getElementById(n+"_page");if(o){var i=new app.Login(t?t.login:n,function(e){onLoginSuccess(e)});o.addELM(i)}},onLoginSuccess=function(e){setCookie("userId",e.id,325),setCookie("session_token",e.getSessionToken(),325),setTimeout(function(){var e=getCookie("lastLoginPath");if(IsEmpty(e))window.location="/";else if("null"==e)window.location="/";else{var t=window.location.toString();if(e.indexOf("#")>-1&&t==e)return void window.location.reload();window.location=e}},800)},loginPopup=function(e){lPopup=new app.Popup,lPopup.init(new app.Login(_LOGIN_PARAMS,function(e){onLoginSuccess(e)})),e&&lPopup.disableClosing(!0),lPopup.show(!0)},startLogin=function(){lPopup||(lPopup=new app.Popup,lPopup.init(new app.Login(_LOGIN_PARAMS,function(e){onLoginSuccess(e)}))),lPopup.show(!0)};String.prototype.toTitleCase=function(){var e,t,n,o,i;for(n=this.replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}),o=["A","An","The","And","But","Or","For","Nor","As","At","By","For","From","In","Into","Near","Of","On","Onto","To","With"],e=0,t=o.length;e<t;e++)n=n.replace(new RegExp("\\s"+o[e]+"\\s","g"),function(e){return e.toLowerCase()});for(i=["Id","Tv"],e=0,t=i.length;e<t;e++)n=n.replace(new RegExp("\\b"+i[e]+"\\b","g"),i[e].toUpperCase());return n},app.Ext(app,{Popup:function(e){var t={},n=t,o=null,i=e,r=null,a=!1,s="popup",l=null,c=cELM("div","popup");c.addEventListener("click",function(e){if(!e)var e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),a||app.Controller.popPopup()}),c.addEventListener("dragover",function(e){e.preventDefault(),c.className=s+" "+(l?l:"")+" dragover"}),c.addEventListener("dragleave",function(e){e.preventDefault(),c.className=s+" "+(l?l:"")}),c.addEventListener("drop",function(e){e.preventDefault(),c.className=s+" "+(l?l:"");var t=e.dataTransfer,n=(t.types,t.files),i=t.items,r=t.getData("url");r||(r=t.getData("text/plain"),r||(r=t.getData("text/uri-list")));var a={dataTransfer:{files:n,items:i,url:r}};o&&o.onDropEvent&&o.onDropEvent(a)});var d=cELM("div","btBack");d.onclick=function(){app.Controller.popPopup()};var u=cELM("div","header"),p=cELM("div","title_container"),f=cELM("div","title");f.readOnly=!0;var g=cELM("div","notification"),v=null,y=cELM("div","header_controls"),h=cELM("div","scroll_content"),L=cELM("div","scroll_spacer");if(h.addELM(L),u.addELM(d),u.addELM(p),p.addELM(f),u.addELM(y),i)if(i.mode){if(c.addELM(u),c.addELM(g),i.controls)for(var M=0;M<i.controls.length;M++){var m=i.controls[M];y.addELM(m)}c.addELM(h)}else c.addELM(g);return e||c.addELM(g),t.disableClosing=function(e){a=e},document.body.appendChild(c),t.setClass=function(e){l=e,c.className=s+" "+l},t.clearNotification=function(){var e=g;e&&(v?(e.removeChild(v),v=null):e.innerHTML="")},t.setNotification=function(e){var t=g;t&&(v?(t.removeChild(v),v=null):t.innerHTML="","string"==typeof e?t.innerHTML=e:"object"==typeof e&&(v=e,t.addELM(e)))},t.getTitle=function(){return h.value},t.init=function(e,n){var a=null;t.clearContent(),o=e,r=n,"string"==typeof n?(c.addELM(o),a=n,a&&t.setClass(a)):"object"==typeof n?(n.title&&(f.innerHTML=n.title),i?h.addELM(o):c.addELM(o),n.css&&t.setClass(n.css),c.addEventListener("click",function(e){if(!e)var e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()})):(c.addELM(o),a=n,a&&t.setClass(a)),o.hasOwnProperty("getELM")?o.getELM().addEventListener("click",function(e){if(!e)var e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}):o.addEventListener("click",function(e){if(!e)var e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()})},t.isShown=function(){return"block"==c.style.display},t.clearContent=function(){o&&(o.getELM?o.getELM().parentNode&&o.getELM().parentNode.removeChild(o.getELM()):o.parentNode&&o.parentNode.removeChild(o)),o=null,c.style.display=""},t.hide=function(e){o.hide?o.hide(function(){c.style.display="none",app.Controller.unlockWindow()}):(c.style.display="none",app.Controller.unlockWindow())},t.show=function(e){e&&"block"==c.style.display||(e="undefined"==typeof e||e,c.style.display=e?"block":"none",o&&o.show&&o.show(e),e?("object"==typeof r&&r.history?app.Controller.pushPopup(n,r.history):app.Controller.pushPopup(n),app.Controller.lockWindow()):(c.style.display="none",app.Controller.unlockWindow()))},t.getHTML=function(){return c},t}}),app.Ext(app,{DAL:{getObjectFromParse:function(e){var t=e.attributes;return t.objectId=e.id,t},setParseObject:function(e,t){for(var n in t)e.set(n,t[n])},loginSocial:function(e){},login:function(e,t,n,o){e&&(e=e.toLowerCase()),Parse.User.logIn(e,t,{success:function(e){Parse.Cloud.run("checkRole",{},{success:function(t){n(e)},error:function(e){o(e)}})},error:function(e,t){o(t)}})},logout:function(){setCookie("username","",325),setCookie("userId","",325),setCookie("session_token","",325),Parse.User.logOut()},signUp:function(e,t,n,o){var i=t,r=e;r&&(r=r.toLowerCase());var a=new Parse.User;a.set("username",r),a.set("password",i),a.set("email",r);var s=r.split("@");a.set("fullname",s[0]),console.log(s[0]),a.signUp(null,{success:function(e){Parse.Cloud.run("checkRole",{},{success:function(t){n(e)},error:function(e){o(e)}})},error:function(e,t){o(t)}})}}}),function(){"use strict";var e=document,t=function(t){return e.getElementById(t)},n=function(t){return e.getElementsByClassName(t)},o="/scripts/sections/",i="/scripts/modules/",r="/css/",a=[],s=[],l={},c=null,d={},u={},p={},f={},g=null,v={},y=function(e){if(!IsEmpty(e)){var i=t("scroll_content"),a=o+e+".js";l[e]&&l[e].host&&(a=l[e].host+o+e+".js");var s=null,u=n("controls_header");if(u&&u.length>0){u[0].className="controls_header "+e+"_header";var p=u[0].querySelector("#header_title");if(p){p.innerHTML="";var g=l[e];g&&g.title&&(p.innerHTML=g.title,s=p)}}var v="bt"+e.toTitleCase(),y=f[v],h=function(e){require([o+e+".js"],function(t){d[e]=t,t.init(app.User.isLogin(),i,s,y),t.render(),c=d[e]},function(e){console.log(e),c=null})};app.Mod(e)?h(e):(console.log("no modules found"),LoadCSS(r+e+".css"),app.RegMods([e],function(){h(e)}))}};app.Ext(app,{Mod:function(e){return u[e]},RegMod:function(e,t){return u[e]?t:void(u[e]=t)},RegMods:function(e,t){for(var n=[],o=e,r=0;r<o.length;r++){var a=o[r];if(!app.Mod(a)){var s=i+a+".js";l[a]&&l[a].host&&(s=l[a].host+i+a+".js"),n.push(s)}}n.length>0&&require(n,function(){for(var e=0;e<arguments.length;e++)app.RegMod(o[e],arguments[e]);t(n)},function(e){console.log(e),t(null)})},Bind:function(e,t,n){for(var o in n){var i=parseInt(o);if(!isNaN(i)){var r=n[o],a=t[o].split("/"),s=a[a.length-1].split("."),l=s[1].toTitleCase(),c=s[0].toLowerCase();"DAL"==s[1]&&(l="DAL"),app.Mod(c)||2!=s.length||app.RegMod(c,r);var d={};d[l]=r,app.Ext(e,d)}}},User:{get:function(){return Parse.User.current()},become:function(e,t){IsEmpty(t)?Parse.User.become(e).then(function(e){var t=Parse.User.current();onLoginSuccess(t)}):alert(t)},isLogin:function(){var e=Parse.User.current();return!!e&&e},login:function(e){},logout:function(e){app.DAL.logout(),setTimeout(function(){e?e():location.reload()},800)}},Controller:{sectionBadges:null,checkFeature:function(e){return v[e]},setFeatureFlags:function(e){v=e},lockWindow:function(){a=[self.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,self.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop];var e=document.getElementsByTagName("html")[0];e.data={},e.data["scroll-position"]=a,e.data["previous-overflow"]=e.style.overflow,e.style.overflow="hidden",window.scrollTo(a[0],a[1])},unlockWindow:function(){var e=document.getElementsByTagName("html")[0],t=e.data["scroll-position"];e.style.overflow=e.data["previous-overflow"],window.scrollTo(t[0],t[1])},clearNotification:function(){var e=document.getElementById("notification");e&&(g?(e.removeChild(g),g=null):e.innerHTML="")},setNotification:function(e){var t=document.getElementById("notification");t&&(g?(t.removeChild(g),g=null):t.innerHTML="","string"==typeof e?t.innerHTML=e:"object"==typeof e&&(g=e,t.addELM(e)))},closePopovers:function(e){if(app.controls.expandButtons)for(var t=0;t<app.controls.expandButtons.length;t++){var n=app.controls.expandButtons[t];"none"!=n.style.display&&(n.style.display="none")}},pushPopup:function(e,t){s.push(e);var n=Math.random(),o={objectHash:n};if(window.location.pathname==t){var i=t.split("/");window.history.replaceState(o,n,"/"+i[1])}window.history.pushState(o,n,t),window.onpopstate=function(e){var t=s.pop();t&&t.hide()}},popPopup:function(){window.history.back()},initSectionSelections:function(e){window.onscroll=function(e){app.Controller.closePopovers(e)},l=e,d={};var t=n("controls_footer"),o=null;if(t&&(o=t[0]),o){o.innerHTML="";var i=cELM("ul");o.addELM(i);for(var r in l){d[r]=null;var a="bt"+r.toTitleCase(),s=cELM("li"),c=cELM("a"),u=cELM("div","button "+a);if(c.addELM(u),c.value=a,c.section=r,c.onclick=function(e){var t=document.location.href;if(window.history.pushState)window.history.pushState(this.section,"","/"+this.section);else{var n=t.indexOf("#")>-1?t.split("#")[0]:document.location.href,o=this.value.substr(2,this.value.length-2).toLowerCase();document.location.href=n+"#"+o}app.Controller.showSection()},s.addELM(c),l[r].hasBadge){var g=cELM("div","badge badge"+r.toTitleCase());c.addELM(g),f[a]=g,_CTRL().sectionBadges&&_CTRL().sectionBadges[r]&&(g.innerHTML=_CTRL().sectionBadges[r])}i.addELM(s),p[a]=u}}},showSection:function(e){var t=document.location.toString();if(!(t.indexOf("/auth/")>-1||t.indexOf("/login")>-1||t.toString().indexOf("/signup")>-1)){var o=[];o=window.history.pushState?getURLParts(document.location):getURLHashPath(document.location);var i="";if(e)i=e;else if(o.length>0){var r=o[0];i=r}else for(var a in d){i=a,window.history.pushState?window.history.pushState(i,"","/"+i):document.location.href=document.location.href+"#"+i;break}var s=c;s&&s.clear&&s.clear();for(var u in p){var f=p[u];f.className="button "+u}var u="bt"+i.toTitleCase();if(p[u]){var f=p[u];f&&(f.className="button "+u+"_selected")}var g=n("controls_header");if(g&&g.length>0){g[0].className="controls_header "+i+"_header";var v=g[0].querySelector("#header_title");if(v){v.innerHTML="";var h=l[i];h&&h.title&&(v.innerHTML=h.title)}}var L=d[i];if(!L){var h=l[i];return h&&h.mods&&h.mods.length>0?app.RegMods(h.mods,function(){h.css&&LoadCSS(h.css),y(i)}):y(i)}L.render(),c=d[i]}}}})}(),app.Ext(app,{Login:function(e,t){var n={},o=t,i=null,r="login",a=!1,s=cELM("div","login");"object"==typeof e?(e.mode&&(r=e.mode),e.isOAuthOnly&&(a=e.isOAuthOnly),i=e):"string"==typeof e&&(r=e);var l=function(e){g.innerHTML="";var t=window.location.href;t.indexOf("/auth/")==-1&&t.indexOf("/login")==-1&&t.indexOf("/signup")==-1?setCookie("lastLoginPath",t,325):setCookie("lastLoginPath",null,325)},c=cELM("INPUT");c.id="txtUsername",c.setAttribute("type","text"),c.setAttribute("placeholder","Email");var d=cELM("INPUT");d.id="txtPassword",d.setAttribute("type","password"),d.setAttribute("placeholder","Password");var u=cELM("INPUT");u.setAttribute("type","text"),u.setAttribute("placeholder","Name"),u.style.display="none";var p=cELM("DIV","txtTitle"),f=cELM("DIV","txtNote"),g=cELM("DIV","error_message"),v=cELM("DIV","textButton");v.id="btForgot",v.innerHTML="Forgot your password?";var y=cELM("DIV","textButton");y.id="btSwitch";var h=cELM("DIV","button");h.id="btAction";var L=cELM("DIV","social"),M=cELM("a","button");M.id="btGmailLogin",M.onclick=function(e){l(),n.show(!1),setTimeout(function(){location.href="/auth/google"},200)};var m=cELM("a","button");m.id="btFacebookLogin",m.onclick=function(e){l(),n.show(!1),setTimeout(function(){location.href="/auth/facebook"},200)};var E=cELM("a","button");E.id="btTwitterLogin",E.onclick=function(e){l(),n.show(!1),setTimeout(function(){location.href="/auth/twitter"},200)},m.innerHTML="with Facebook",E.innerHTML="with Twitter",M.innerHTML="with Google";var b=function(e){r=e,f.innerHTML="",g.innerHTML="",c.style.visibility="visible","forgot"==r?(L.style.display="none",s.className="login forgot",p.innerHTML="Reset Password",mode="forgot",h.innerHTML="Reset Password",y.innerHTML="or login",v.style.visibility="hidden",v.style.display="none",d.style.visibility="hidden"):"login"==r?(L.style.display="block",s.className="login",p.innerHTML="Please Login",r="login",h.innerHTML="Login",y.innerHTML="or signup now",v.style.visibility="visible",v.style.display="block",d.style.visibility="visible",n.showControls(!0)):"signup"==r&&(L.style.display="block",s.className="login signup",p.innerHTML="Please Sign Up",r="signup",h.innerHTML="Signup",y.innerHTML="or login",v.style.display="none",d.style.visibility="visible",n.showControls(!0),u.style.display="block")};return v.onclick=function(e){b("forgot")},h.onclick=function(e){n.loginOrSignup()},y.onclick=function(e){"signup"==r?b("login"):"login"==r?b("signup"):"forgot"==r&&b("login")},window.addEventListener("keypress",function(e){13==e.keyCode&&n.loginOrSignup()},!1),n.showControls=function(e){e?(h.style.visibility="visible",y.style.visibility="visible"):(h.style.visibility="hidden",y.style.visibility="hidden")},n.show=function(e){s.style.display=e?"block":"none"},n.loginOrSignup=function(){n.showControls(!1);var e=function(){c.style.display="none",d.style.display="none",v.style.visibility="hidden",L.style.display="none"},t=function(){c.style.display="block",d.style.display="block","forgot"!=r&&(v.style.visibility="block"),L.style.display="block"};e(),"signup"==r?(l(),p.innerHTML="Signing up </br> </br> Please wait...",app.DAL.signUp(c.value,d.value,function(e){o(e)},function(e){t(),n.error(e)})):"login"==r?(l(),p.innerHTML="Logging in </br></br> Please wait...",app.DAL.login(c.value,d.value,function(e){o(e)},function(e){t(),n.error(e)})):"forgot"==r&&(p.innerHTML="Resetting Password...",c.style.visibility="hidden",setTimeout(function(){p.innerHTML="Password Reset",f.innerHTML="An email was sent with a link to create a new password. <br/>Don't forget to check your spam folder, if you don't see the email",r="signup",y.innerHTML="Login",y.style.visibility="visible",d.style.visibility="hidden"},1e3))},n.error=function(e){b(r),n.showControls(!0),g.innerHTML=e.code+" "+e.message},n.getELM=function(){return s},n.getHTML=function(){if(s.addELM(p),i&&(i.google&&L.addELM(M),i.facebook&&L.addELM(m),i.twitter&&L.addELM(E),i.google||i.facebook||i.twitter)){var e=cELM("DIV","loginor");e.innerHTML="or",a||L.addELM(e),s.addELM(L)}s.addELM(f);var t=cELM("DIV","");return a||(i&&i.hasName&&t.addELM(u),t.addELM(c),t.addELM(d),t.addELM(v),t.addELM(h),t.addELM(y),s.addELM(t)),s.addELM(g),b(r),s},n}}),app.Ext(app,{controls:{Selections:function(e){var t=function(e){var t=this,n=e.onAdd,o=e.onFocus,i=e.onBlur,r=e.onKeyup,a=cELM("div","selection_header"),s=cELM("div","loading"),l=cELM("input","input_text"),c=cELM("div","button btAdd"),d=cELM("div","button btOK");d.style.display="none";var u=function(e){l.readOnly=!1,l.style.display="block",d.style.display="none",c.style.display="block",e&&(l.value="")},p=function(){c.style.display="none",d.style.display="block"},f=function(){l.blur(),l.style.display="none",d.style.display="none",c.style.display="none"};c.onclick=function(e){l.focus()},d.onclick=function(e){f(),n(l.value,u)},l.onkeyup=function(e){r&&r(l.value)},l.onkeypress=function(e){13==e.keyCode?(f(),n(l.value,u)):p()},t.reset=function(e){l.value="",l.style.display="block",c.style.display="block",d.style.display="none",l.blur()},l.onfocus=function(e){c.style.display="none",o&&o()},l.onblur=function(e){i&&i(),IsEmpty(l.value)&&(l.style.display="block",c.style.display="block",d.style.display="none")},t.getELM=function(){return a},t.getHTML=function(){return a.addELM(s),a.addELM(l),a.addELM(c),a.addELM(d),a}},n=function(e){var t=this,n=e.onSearch,o=e.onFocus,i=e.onBlur,r=e.onFilter,a=(e.onKeyup,cELM("div","selection_header selection_search")),s=cELM("div","loading"),l=cELM("input","input_text"),c=cELM("div","button btSearch"),d=cELM("div","button btOK");d.style.display="none";var u=!1,p=function(e){l.readOnly=!1},f=function(){c.style.display="none",d.style.display="block"},g=function(){l.blur()};c.onclick=function(e){l.focus()},d.onclick=function(e){g(),n(l.value,p)},l.onKeyup=function(e){r&&r(l.value)},l.onkeypress=function(e){13==e.keyCode?(g(),n(l.value,p)):f()},t.reset=function(e){l.value="",l.style.display="block",c.style.display="block",d.style.display="none",l.blur()},l.onfocus=function(e){c.style.display="none",o&&(u||(u=!0,o()))},l.onblur=function(e){i&&i(),IsEmpty(l.value)&&(l.style.display="block",c.style.display="block",d.style.display="none")},t.getELM=function(){return a},t.getHTML=function(){return a.addELM(s),a.addELM(l),a.addELM(c),a.addELM(d),a}},o=function(e,t){var n=this,o=e,i=e.isSelected,r=t.template,a=t.onSelect,s=cELM("div","selection");return n.update=function(e){o=e,i=e.isSelected,s.className=i?"selection selected":"selection"},n.getData=function(){return o},n.getELM=function(){return s},n.getHTML=function(){if(r){var e=r(o);s.innerHTML=e}return n.update(o),s},n.select=function(e,t){o.isSelected=e,n.update(o),a(i,o,t)},o.onclick?s.onclick=o.onclick:s.onclick=function(e){n.select(!i,e)},n},i=this,r={},a=e,s={},l={},c=null,d=e.getData,u=e.finishedSelection,p=e.addData,f=e.searchData,g=e.onShow,v=e.onDone,y=e.onSelect,h=e.onFocus,L=e.onBlur,M=e.onFilter,m=(cELM.onSelect,e.footer),E=[],b=null;e.itemTemplate&&(b=e.itemTemplate);var w=cELM("div","selections");e.cssName&&(w=cELM("div","selections "+e.cssName));var k=cELM("div","content"),T=cELM("div","content_scroll"),C=cELM("div","background_text");C.innerHTML="Loading...",C.style.display="block",T.addELM(C);var S=cELM("div","placeholder_empty");a.emptyMessage&&(S.innerHTML=a.emptyMessage,S.style.display="none",T.addELM(S));var P=cELM("div","selection adding");P.innerHTML="Adding ...";var H=cELM("div","btDone");H.style.display="none",H.onclick=function(e){i.onDone()};var A=function(e){k.scrollTop=0;for(var t in r){var n=r[t];n.getELM().parentNode.removeChild(n.getELM())}r={};for(var o=0;o<e.length;o++)x(e[o],!1);0==e.length&&a.emptyMessage&&(C.style.display="none",S.style.display="block")},x=function(e,t){var n=null;if(e.id?n=e.id:e._id&&(n=e._id),r[n])r[n].update(e);else{var a=new o(e,{template:b,onSelect:i.onSelect});r[n]=a,t?k.insertELM(a):k.addELM(a)}},N=null;if(p)N=t({onKeyup:function(e){M&&M(e,E,A)},onFocus:function(){h&&h(i.update)},onBlur:function(){L&&L(i.update)},onAdd:function(e,t){k.insertELM(P),p(e,c,function(e){P.parentNode.removeChild(P),t(e),I();for(var n=0;n<e.length;n++){var o=e[n];o.isSelected=!0,x(o,!0);var i=null;o.id?i=data.id:o._id&&(i=o._id),s[i]=o}T.scrollTop=0})}});else if(f){var B=function(){k.scrollTop=0,s={},l={};for(var e in r){var t=r[e];t.getELM().parentNode.removeChild(t.getELM())}r=[]};N=new n({onFocus:function(){h&&(B(),h(i.update,E,A))},onBlur:function(){L&&L(i.update)},onSearch:function(e,t){S.style.display="none",C.style.display="block",B(),f(e,c,function(e){C.style.display="none",t(e);for(var n=0;n<e.length;n++){var o=e[n];x(o,!0)}T.scrollTop=0,0==e.length&&a.emptyMessage&&(S.innerHTML='Can\'t find a friend? <br/><a class="email" title="Email a friend" href="" onclick="javascript:window.location=\'mailto:?subject=Feedback on Bestlyst?&body=I thought you might have great feedback or ideas for Bestlyst: \' + window.location;">Invite</a> them to bestlyst.',S.style.display="block",T.addELM(S))})}})}var I=function(){k.scrollTop=0;for(var e in r){var t=r[e];t.getELM().parentNode.removeChild(t.getELM())}r={};for(var n=0;n<E.length;n++)x(E[n],!1)},_=function(){s={},l={},H.style.display="none",S.style.display="none",N&&(N.getELM().style.display="none"),k.scrollTop=0;for(var e in r){var t=r[e];t.getELM().parentNode.removeChild(t.getELM())}r={},k.style.display="block"};return i.getELM=function(){return w},i.getHTML=function(){return(p||f)&&w.addELM(N),a.headerTemplate&&w.addELM(a.headerTemplate),T.addELM(k),w.addELM(T),m&&w.addELM(m),b&&w.addELM(H),w},i.onSelect=function(e,t,n){var o=null;t.id?o=t.id:t._id&&(o=t._id),e?(s[o]=t,l[o]&&delete l[o]):(l[o]=t,s[o]&&delete s[o]),y&&y(e,t,n)},i.getSelections=function(){return{session:c,selected:s,unselected:l}},i.update=function(e){if(e){E=e,H.style.display="block",N&&(N.getELM().style.display="block"),e.length>0?(C.style.display="none",S.style.display="none"):a.emptyMessage&&(C.style.display="none",S.style.display="block");for(var t=0;t<e.length;t++)x(e[t],!1);m&&m.show()}},i.disableContent=function(e){H.style.display="none",N&&(N.getELM().style.display="none"),k.scrollTop=0,k.style.display="none",e&&(C.innerHTML=e),C.style.display="block"},i.finish=function(){N&&N.reset(),u&&u(c,s,l)},i.show=function(e){1==e&&(_(),C.style.display="block",C.innerHTML="Loading...",d&&(m&&m.hide(),d(c,i.update))),g&&g(e)},i.setSessionData=function(e){c=e,m&&m.setSessionData&&m.setSessionData(e)},i.onDone=function(){v&&v()},i},BindInputsToData:function(e,t){var n=this,o=t,i=e.css,r=e.onChange;e.onAdd,e.onDelete;o||(o={});var a={},s={},l=cELM("div",i);e.template?l.innerHTML=e.template:e.dom&&(l=e.dom);var c=function(e){var t=this.getAttribute("data-type"),n=this.getAttribute("data-value"),i=this.getAttribute("data-table-column"),a=this.type,s=(this.source,this.rowIdx),l=this.column;if("picker"==t)if(o[this.source]||(o[this.source]=[]),i)if(this.checked){var c={};c.guid=guidGenerator(),c[i]=n,o[this.source].push(c)}else{for(var d=-1,u=0;u<o[this.source].length;u++){var c=o[this.source][u];c[i]==n&&(d=u)}o[this.source].splice(d,1)}else if(this.checked)o[this.source].push(n);else{for(var d=-1,u=0;u<o[this.source].length;u++){var p=o[this.source][u];p==n&&(d=u)}o[this.source].splice(d,1)}else{var f=null;if("checkbox"==a||"radio"==a){var g=this.getAttribute("name");if(g)for(var v=document.querySelectorAll('input[name="'+g+'"]'),y=0;y<v.length;y++){var h=v[y],L=h.getAttribute("data-src");o[L]&&(o[L]=!1)}f=this.checked}else f=this.value;void 0===s?o[this.source]=f:o[this.source][s][l]=f}r&&r(this.source,this)},d=function(e,t,n,o){for(var i="input["+n+"]",r="textarea["+n+"]",s=e.querySelectorAll(i),l=e.querySelectorAll(r),d=[],u=0;u<s.length;u++)d.push(s[u]);for(var u=0;u<l.length;u++)d.push(l[u]);for(var u=0;u<d.length;u++){var p=d[u].getAttribute("data-type"),f=d[u].getAttribute("data-value"),g=d[u].getAttribute("data-table-column"),v=(d[u].type,d[u]),y=d[u].getAttribute(n);v.source=y,v.onchange=c,v.onkeyup=c;var h=v.source;if(o){var L=o.split("|"),M=L[0],m=L[1];v.source=M,v.rowIdx=m,v.column=g,a[M]||(a[M]=[]),a[M][m]||(a[M][m]={}),a[M][m][g]=v}else g&&g!=y&&(h=h+"|"+g),f&&(h=h+"|"+f),a[h]?"data-table-column"==n||!p||"picker"==p||console.log("duplicate: "+h):a[h]=v}},u=l.querySelectorAll('div[data-format="table"]'),p=function(e,t,n){var i={};i.guid=guidGenerator(),t&&(i=t);var l=0;void 0!==n?l=n:o[this.source]&&(l=o[this.source].length);var c=this.template.cloneNode(!0);d(c,i,"data-table-column",this.source+"|"+l),c.guid=i.guid,s[this.source]||(s[this.source]=[]),s[this.source][l]=c;for(var u=0;u<c.childNodes.length;u++){var p=c.childNodes[u];"INPUT"==p.nodeName&&(p.value=null)}var f=c.querySelector('div[data-control="delete"]');f&&(f.template=c,f.source=v,f.onclick=function(e){this.template.parentNode&&this.template.parentNode.removeChild(this.template);for(var t=o[this.source],n=-1,i=0;i<t.length;i++){var s=t[i].guid;if(s&&s==this.template.guid){n=i;break}}n>-1&&(a[this.source].splice(n,1),o[this.source].splice(n,1),r(this.source,this))}),this.parentNode.insertBefore(c,this),t||o[this.source].push(i)};d(l,o,"data-src");for(var f=0;f<u.length;f++){var g=u[f],v=g.getAttribute("data-src"),y=g.querySelector('div[data-format="row"]'),h=g.querySelector('div[data-control="add"]');if(h.template=y,h.source=v,h.onclick=p,y.parentNode.removeChild(y),o[v])if(0==o[v].length)h.onclick();else for(var L=0;L<o[v].length;L++){var M=o[v][L];h.onclick(null,M,L)}else o[v]=[],h.onclick()}var m=function(e,t){var n=e.type,o=(e.getAttribute("data-src"),e.getAttribute("data-type"));e.getAttribute("data-value"),e.getAttribute("data-table-column");"picker"==o?e.checked=!0:"checkbox"==n||"radio"==n?e.checked=t:e.value=t};return n.update=function(e){for(var t in e){var n=e[t];if(Array.isArray(n)){var i=n.length-o[t].length;if(i>0)for(var r=0;r<u.length;r++){var l=u[r],c=l.getAttribute("data-src");if(c==t){var d=l.querySelector('div[data-control="add"]');if(d)for(var p=n.length,f=p-i;f<n.length;f++){var g=n[f];d.onclick(null,g,f)}}}else if(i<0){for(var p=s[t].length,r=p+i;r<Math.abs(p);r++){var v=s[t][r];v.parentNode&&v.parentNode.removeChild(v)}for(var r=0;r<Math.abs(i);r++)s[t].splice(s[t].length-1,1)}}o[t]=e[t]}for(var c in o){var y=o[c];if(Array.isArray(y))for(var r=0;r<y.length;r++){var h=y[r],L=r;if(a[c]&&a[c][L])for(var M in h){var E=h[M],b=M,w=c+"|"+M+"|"+E;a[c][L][b]&&m(a[c][L][b],E),a[w.trim()]&&m(a[w.trim()],E)}}else{var k=c;a[k]&&m(a[k],y)}}},n.getData=function(){return o},n.getELM=function(){return l},n.getHTML=function(){return l},n.update(o),n},BindModelToInputs:function(e,t,n,o){var r=cELM("div",e);for(var a in t)if("form"==n||"form_withLabel"==n){var s=!1;if(Array.isArray?Array.isArray(t[a])&&(s=!0):"[object Array]"===Object.prototype.toString.call(t[a])&&(s=!0),s)for(i=0;i<t[a].length;i++);}else if("data"==n&&"object"==typeof t[a])for(subProp in t[a]);return r},ExpandButton:function(e){var t={},n=e,o=cELM("div","button_expand "+n.classname),i=cELM("div","button");i.innerHTML=e.button_text;var r=cELM("div","expand");r.style.display="none";var a=cELM("div","arrow_up1");r.addELM(a);var s=cELM("div","arrow_up2");r.addELM(s);var l=cELM("div","spacing");l.innerHTML="",r.addELM(l);for(var c=0;c<e.selections.length;c++){var d=e.selections[c],u=cELM("div","section "+d.classname);u.onclick=d.onclick;var p=cELM("div","icon");u.addELM(p);var f=cELM("div","text");f.innerHTML=d.text,u.addELM(f);var g=cELM("div","detail_text");g.innerHTML=d.detailText,u.addELM(g),r.addELM(u)}return i.onclick=function(e){if(app.controls.expandButtons)for(var t=0;t<app.controls.expandButtons.length;t++)app.controls.expandButtons[t]!=r&&(app.controls.expandButtons[t].style.display="none");if(!e)var e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),"none"==r.style.display?r.style.display="block":r.style.display="none"},t.click=function(e){i.onclick(e)},t.getHTML=function(){return app.controls.expandButtons||(app.controls.expandButtons=[]),app.controls.expandButtons.push(r),document.body.addEventListener("click",function(e){
if(!e)var e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),r.style.display="none"}),o.addELM(i),o.addELM(r),o},t},ProgressBar:function(e){var t={},n=cELM("div","progress"),o=cELM("div","progress-bar"),i=cELM("div","progress-bar-label");return t.update=function(e){o.style.width=e+"%",i.innerHTML=e+"%"},t.getELM=function(){return n},t.getHTML=function(){return n.addELM(o),n.addELM(i),n},t},Segment:function(e){var t={},n=e,o=cELM("div","segments"),i=[],r=function(){for(var e=0;e<i.length;e++)i[e].className="segment"};if(n.segments)for(var a=0;a<n.segments.length;a++){var s=n.segments[a],l=cELM("div","segment");0==a&&(l.className="segment selected"),l.innerHTML=s.label,l.value=s.value,l.onSelect=s.onSelect,l.onclick=function(e){r(),this.className="segment selected",this.onSelect(this.value)},o.addELM(l),i.push(l)}return t.getELM=function(){return o},t.getHTML=function(){return o},t}}});
//# sourceMappingURL=app.min.js.map
